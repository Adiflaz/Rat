<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PlutoXTeam Monitor</title>

<link rel="stylesheet" href="css/style.css">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script src="js/theme.js"></script>
</head>

<body>

<div class="layout">
<div class="sidebar-overlay"></div>

<aside class="sidebar">
<a href="index.html" class="brand">
<img src="img/logo.jpg" style="height:32px;width:32px;border-radius:6px;object-fit:cover">
PlutoXTeam
</a>

<div class="nav-title">Main</div>

<a href="index.html" class="nav-link active">
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="2">
<path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
</svg>
All Devices
</a>

<a href="remote.html" class="nav-link">
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
stroke="currentColor" stroke-width="2">
<circle cx="12" cy="12" r="10"/>
<line x1="12" y1="6" x2="12" y2="12"/>
<line x1="12" y1="12" x2="12" y2="18"/>
</svg>
Remote Tool
</a>

<!-- LOGOUT -->
<button onclick="logout()" class="nav-link"
style="margin-top:auto;color:#ef4444;background:none;border:none;text-align:left;">
Logout
</button>

</aside>

<main class="content">

<div class="mobile-header">
<button class="mobile-toggle">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
d="M4 6h16M4 12h16M4 18h16"/>
</svg>
</button>

<div class="mobile-brand">
<img src="img/logo.jpg" style="height:28px;width:28px;border-radius:4px">
PlutoXTeam
</div>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;">
<h1>Dashboard</h1>
<div id="connection-status" class="status-badge">Connecting...</div>
</div>

<div class="stats-grid">
<div class="stat-card">
<div class="stat-value" id="total-devices">0</div>
<div class="stat-label">Total Devices</div>
</div>

<div class="stat-card">
<div class="stat-value" id="online-devices">0</div>
<div class="stat-label">Online</div>
</div>

<div class="stat-card">
<div class="stat-value" id="offline-devices">0</div>
<div class="stat-label">Offline</div>
</div>
</div>

<div class="card">
<h2>Connected Devices</h2>
<div class="table-container">
<table>
<thead>
<tr>
<th>Status</th>
<th>Device Name</th>
<th>Android Ver</th>
<th>Battery</th>
<th>IP Address</th>
<th>Last Seen</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="devices-table-body">
<tr>
<td colspan="7" style="text-align:center;">Loading devices...</td>
</tr>
</tbody>
</table>
</div>
</div>

</main>
</div>

<div class="footer">Powered by PlutoXTeam</div>

<!-- SCRIPT ASLI (TIDAK DIUBAH) -->
<script src="js/firebase_config.js"></script>
<script src="js/ui.js"></script>
<script src="js/app.js"></script>
<script src="js/integrity.js"></script>

<script>
/* ===== AUTH GUARD (ANTI LOOP) ===== */
firebase.auth().onAuthStateChanged(user=>{
  if(user === null){
    // kasih delay dikit biar auth kebaca
    setTimeout(()=>{
      if(!firebase.auth().currentUser){
        location.href="login.html";
      }
    },500);
  }
});

/* ===== LOGOUT ===== */
function logout(){
  firebase.auth().signOut().then(()=>{
    location.href="login.html";
  });
}
</script>

</body>
</html>